# データモデル: 日本語絵文字名対応（ひらがな・カタカナ・漢字）

**フィーチャーブランチ**: `003-japanese-emoji-name`
**作成日**: 2026-02-22

---

## エンティティ変更

### 変更なし

本改修では型定義・データモデルの変更はない。

- `EmojiStatus`: 変更なし（Pending, Uploading, Success, Failed, Skipped）
- `EmojiRegistrationItem`: 変更なし（`emojiName: string` が日本語文字を含むようになるが、型レベルの変更ではない）
- `EmojiAddResponse`: 変更なし

---

## バリデーションルール

### 絵文字名の正規化ルール（変更）

**変更前**: 5ステップ正規化

| ステップ | 処理 | 正規表現 |
|---------|------|---------|
| 1 | 拡張子を除去 | N/A |
| 2 | 大文字を小文字に変換 | N/A |
| 3 | 空白・ドットを `_` に置換 | `/[\s.]+/g` |
| 4 | **英小文字・数字・ハイフン・アンダースコア以外を除去** | **`/[^a-z0-9\-_]/g`** |
| 5 | 空文字列チェック | N/A |

**変更後**: 5ステップ正規化（ステップ4の正規表現のみ変更）

| ステップ | 処理 | 正規表現 |
|---------|------|---------|
| 1 | 拡張子を除去 | N/A |
| 2 | 大文字を小文字に変換 | N/A |
| 3 | 空白・ドットを `_` に置換 | `/[\s.]+/g` |
| 4 | **英小文字・数字・ハイフン・アンダースコア・日本語文字以外を除去** | **`/[^a-z0-9\-_\u3040-\u309F\u30A0-\u30FF\u4E00-\u9FFF\u3400-\u4DBF\uF900-\uFAFF]/g`** |
| 5 | 空文字列チェック | N/A |

### 許可されるUnicode範囲

| 文字種 | Unicode範囲 | 文字数 | 例 |
|--------|------------|--------|-----|
| ASCII小文字 | U+0061-U+007A | 26 | a-z |
| ASCII数字 | U+0030-U+0039 | 10 | 0-9 |
| ハイフン | U+002D | 1 | - |
| アンダースコア | U+005F | 1 | _ |
| ひらがな | U+3040-U+309F | 96 | あ-ん、ゔ、ゝ-ゞ |
| カタカナ | U+30A0-U+30FF | 96 | ア-ン、ヴ、ー、ヽ-ヾ |
| CJK統合漢字 | U+4E00-U+9FFF | 20,992 | 一-龥 |
| CJK統合漢字拡張A | U+3400-U+4DBF | 6,592 | 㐀-䶵 |
| CJK互換漢字 | U+F900-U+FAFF | 512 | 豈-頻 |
